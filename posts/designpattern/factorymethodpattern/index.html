<p>工廠方法模式（Factory Method Pattern）是一種創建型模式，旨在提供一種方式來創建物件，並隱藏實際創建物件的細節。以下是工廠模式的四個要素：</p>
<h2 id=簡介>簡介</h2>
<ol>
<li><strong>模式名稱</strong>：</li>
</ol>
<blockquote>
<p>工廠方法模式</p>
</blockquote>
<ol start=2>
<li><strong>問題</strong>：</li>
</ol>
<blockquote>
<p>需要一種方式來創建物件，並將創建物件的細節隱藏起來。</p>
</blockquote>
<ol start=3>
<li><strong>解決方案</strong>：</li>
</ol>
<blockquote>
<p>使用一個工廠類別來封裝物件的創建邏輯。客戶端只需要提供所需物件的參數，並由工廠類別負責創建物件。</p>
</blockquote>
<ol start=4>
<li><strong>結果</strong>：</li>
</ol>
<blockquote>
<p>隱藏了創建物件的細節，使得客戶端可以輕鬆地獲取所需物件。</p>
</blockquote>
<h2 id=優點>優點</h2>
<blockquote>
<p>避免了創建者和產品之間的緊密耦合。</p>
</blockquote>
<blockquote>
<p><a href=https://mars23003.github.io/blog/posts/designpattern/solid/#%E5%96%AE%E4%B8%80%E8%81%B7%E8%B2%AC%E5%8E%9F%E5%89%87single-responsibility-principlesrp><strong>S 單一職責原則</strong></a>。將產品的功能單一化，只需要做自己的任務就好。</p>
</blockquote>
<blockquote>
<p><a href=https://mars23003.github.io/blog/posts/designpattern/solid/#%E9%96%8B%E6%94%BE%E5%B0%81%E9%96%89%E5%8E%9F%E5%89%87open-closed-principleocp><strong>O 開放/封閉原則</strong></a>。可以在不修改當前程式碼的情況下將新類型的產品引入。</p>
</blockquote>
<h2 id=缺點>缺點</h2>
<blockquote>
<p>程式碼隨著規模將變得越來越複雜</p>
</blockquote>
<h2 id=簡單工廠模式simple-factory-pattern>簡單工廠模式（Simple Factory Pattern）：</h2>
<p><strong>以下我們來用食品工廠當作範例範例，其產品為牛肉麵、拉麵、義大利麵。</strong></p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=k>public</span> <span class=k>interface</span> <span class=n>IFood</span>
<span class=p>{</span>
    <span class=k>void</span> <span class=n>Make</span><span class=p>();</span>
<span class=p>}</span>

<span class=k>public</span> <span class=k>class</span> <span class=nc>BeefNoodle</span> <span class=p>:</span> <span class=n>IFood</span>
<span class=p>{</span>
    <span class=k>public</span> <span class=k>void</span> <span class=n>Make</span><span class=p>()</span>
    <span class=p>{</span>
        <span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=s>&#34;製作牛肉麵...&#34;</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=k>public</span> <span class=k>class</span> <span class=nc>Ramen</span> <span class=p>:</span> <span class=n>IFood</span>
<span class=p>{</span>
    <span class=k>public</span> <span class=k>void</span> <span class=n>Make</span><span class=p>()</span>
    <span class=p>{</span>
        <span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=s>&#34;製作拉麵...&#34;</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=k>public</span> <span class=k>class</span> <span class=nc>Spaghetti</span> <span class=p>:</span> <span class=n>IFood</span>
<span class=p>{</span>
    <span class=k>public</span> <span class=k>void</span> <span class=n>Make</span><span class=p>()</span>
    <span class=p>{</span>
        <span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=s>&#34;製作義大利麵...&#34;</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=k>public</span> <span class=k>class</span> <span class=nc>FoodFactory</span>
<span class=p>{</span>
    <span class=k>public</span> <span class=n>IFood</span> <span class=n>CreateFood</span><span class=p>(</span><span class=kt>string</span> <span class=n>foodType</span><span class=p>)</span>
    <span class=p>{</span>
        <span class=k>switch</span> <span class=p>(</span><span class=n>foodType</span><span class=p>.</span><span class=n>ToLower</span><span class=p>())</span>
        <span class=p>{</span>
            <span class=k>case</span> <span class=s>&#34;beefnoodle&#34;</span><span class=p>:</span>
                <span class=k>return</span> <span class=k>new</span> <span class=n>BeefNoodle</span><span class=p>();</span>
            <span class=k>case</span> <span class=s>&#34;ramen&#34;</span><span class=p>:</span>
                <span class=k>return</span> <span class=k>new</span> <span class=n>Ramen</span><span class=p>();</span>
            <span class=k>case</span> <span class=s>&#34;spaghetti&#34;</span><span class=p>:</span>
                <span class=k>return</span> <span class=k>new</span> <span class=n>Spaghetti</span><span class=p>();</span>
            <span class=k>default</span><span class=p>:</span>
                <span class=k>throw</span> <span class=k>new</span> <span class=n>ArgumentException</span><span class=p>(</span><span class=s>&#34;Invalid food type&#34;</span><span class=p>);</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=k>public</span> <span class=k>class</span> <span class=nc>Client</span>
<span class=p>{</span>
    <span class=k>public</span> <span class=k>void</span> <span class=n>Main</span><span class=p>()</span>
    <span class=p>{</span>
        <span class=n>FoodFactory</span> <span class=n>factory</span> <span class=p>=</span> <span class=k>new</span> <span class=n>FoodFactory</span><span class=p>();</span>

        <span class=n>IFood</span> <span class=n>food1</span> <span class=p>=</span> <span class=n>factory</span><span class=p>.</span><span class=n>CreateFood</span><span class=p>(</span><span class=s>&#34;beefnoodle&#34;</span><span class=p>);</span>
        <span class=n>food1</span><span class=p>.</span><span class=n>Make</span><span class=p>();</span>

        <span class=n>IFood</span> <span class=n>food2</span> <span class=p>=</span> <span class=n>factory</span><span class=p>.</span><span class=n>CreateFood</span><span class=p>(</span><span class=s>&#34;ramen&#34;</span><span class=p>);</span>
        <span class=n>food2</span><span class=p>.</span><span class=n>Make</span><span class=p>();</span>

        <span class=n>IFood</span> <span class=n>food3</span> <span class=p>=</span> <span class=n>factory</span><span class=p>.</span><span class=n>CreateFood</span><span class=p>(</span><span class=s>&#34;spaghetti&#34;</span><span class=p>);</span>
        <span class=n>food3</span><span class=p>.</span><span class=n>Make</span><span class=p>();</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div><blockquote>
<p>在以上的範例中，簡單工廠模式主要是在 FoodFactory 類別中進行了產品的建立，而客戶端需要透過工廠來取得產品物件。</p>
</blockquote>
<h2 id=工廠方法模式factory-method-pattern>工廠方法模式（Factory Method Pattern）：</h2>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=k>public</span> <span class=k>interface</span> <span class=n>IFood</span>
<span class=p>{</span>
    <span class=k>void</span> <span class=n>Make</span><span class=p>();</span>
<span class=p>}</span>

<span class=k>public</span> <span class=k>class</span> <span class=nc>BeefNoodle</span> <span class=p>:</span> <span class=n>IFood</span>
<span class=p>{</span>
    <span class=k>public</span> <span class=k>void</span> <span class=n>Make</span><span class=p>()</span>
    <span class=p>{</span>
        <span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=s>&#34;製作牛肉麵...&#34;</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=k>public</span> <span class=k>class</span> <span class=nc>Ramen</span> <span class=p>:</span> <span class=n>IFood</span>
<span class=p>{</span>
    <span class=k>public</span> <span class=k>void</span> <span class=n>Make</span><span class=p>()</span>
    <span class=p>{</span>
        <span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=s>&#34;製作拉麵...&#34;</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=k>public</span> <span class=k>class</span> <span class=nc>Spaghetti</span> <span class=p>:</span> <span class=n>IFood</span>
<span class=p>{</span>
    <span class=k>public</span> <span class=k>void</span> <span class=n>Make</span><span class=p>()</span>
    <span class=p>{</span>
        <span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=s>&#34;製作義大利麵...&#34;</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=k>public</span> <span class=k>interface</span> <span class=n>IFoodFactory</span>
<span class=p>{</span>
    <span class=n>IFood</span> <span class=n>CreateFood</span><span class=p>();</span>
<span class=p>}</span>

<span class=k>public</span> <span class=k>class</span> <span class=nc>BeefNoodleFactory</span> <span class=p>:</span> <span class=n>IFoodFactory</span>
<span class=p>{</span>
    <span class=k>public</span> <span class=n>IFood</span> <span class=n>CreateFood</span><span class=p>()</span>
    <span class=p>{</span>
        <span class=k>return</span> <span class=k>new</span> <span class=n>BeefNoodle</span><span class=p>();</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=k>public</span> <span class=k>class</span> <span class=nc>RamenFactory</span> <span class=p>:</span> <span class=n>IFoodFactory</span>
<span class=p>{</span>
    <span class=k>public</span> <span class=n>IFood</span> <span class=n>CreateFood</span><span class=p>()</span>
    <span class=p>{</span>
        <span class=k>return</span> <span class=k>new</span> <span class=n>Ramen</span><span class=p>();</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=k>public</span> <span class=k>class</span> <span class=nc>SpaghettiFactory</span> <span class=p>:</span> <span class=n>IFoodFactory</span>
<span class=p>{</span>
    <span class=k>public</span> <span class=n>IFood</span> <span class=n>CreateFood</span><span class=p>()</span>
    <span class=p>{</span>
        <span class=k>return</span> <span class=k>new</span> <span class=n>Spaghetti</span><span class=p>();</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=k>public</span> <span class=k>class</span> <span class=nc>Client</span>
<span class=p>{</span>
    <span class=k>public</span> <span class=k>void</span> <span class=n>Main</span><span class=p>()</span>
    <span class=p>{</span>
        <span class=n>IFoodFactory</span> <span class=n>factory1</span> <span class=p>=</span> <span class=k>new</span> <span class=n>BeefNoodleFactory</span><span class=p>();</span>
        <span class=n>IFood</span> <span class=n>food1</span> <span class=p>=</span> <span class=n>factory1</span><span class=p>.</span><span class=n>CreateFood</span><span class=p>();</span>
        <span class=n>food1</span><span class=p>.</span><span class=n>Make</span><span class=p>();</span>

        <span class=n>IFoodFactory</span> <span class=n>factory2</span> <span class=p>=</span> <span class=k>new</span> <span class=n>RamenFactory</span><span class=p>();</span>
        <span class=n>IFood</span> <span class=n>food2</span> <span class=p>=</span> <span class=n>factory2</span><span class=p>.</span><span class=n>CreateFood</span><span class=p>();</span>
        <span class=n>food2</span><span class=p>.</span><span class=n>Make</span><span class=p>();</span>

        <span class=n>IFoodFactory</span> <span class=n>factory3</span> <span class=p>=</span> <span class=k>new</span> <span class=n>SpaghettiFactory</span><span class=p>();</span>
        <span class=n>IFood</span> <span class=n>food3</span> <span class=p>=</span> <span class=n>factory3</span><span class=p>.</span><span class=n>CreateFood</span><span class=p>();</span>
        <span class=n>food3</span><span class=p>.</span><span class=n>Make</span><span class=p>();</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div><blockquote>
<p>在以上的範例中，工廠方法模式則是把產品的建立交由工廠子類別來實現，而客戶端只需要透過工廠介面與產品介面來使用產品。</p>
</blockquote>
<p>以上是 Factory Method Pattern 的二種不同的實作方式，可以根據不同的需求來選擇適合的方式來實現。</p>
<h2 id=factory-method-pattern的重點整理>Factory Method Pattern的重點整理：</h2>
<ol>
<li>
<p>工廠方法模式是一種創建型設計模式，它可以將對象的創建過程封裝在一個工廠中，使得客戶端不需要知道如何創建對象。</p>
</li>
<li>
<p>工廠方法模式通常包含一個抽象工廠類別和多個具體工廠類別，每個具體工廠類別負責創建一種產品。</p>
</li>
<li>
<p>工廠方法模式的核心是工廠方法，這個方法用於創建對象，並且返回創建的對象給客戶端使用。</p>
</li>
<li>
<p>工廠方法模式可以解決客戶端如何創建對象的問題，同時也可以方便地添加新的產品，而不需要修改現有的代碼。</p>
</li>
<li>
<p>工廠方法模式可以與其他設計模式結合使用，例如抽象工廠模式、單例模式等。</p>
</li>
<li>
<p>在C#中實現工廠方法模式，通常使用一個抽象工廠類別和多個具體工廠類別，以及一個產品介面和多個具體產品類別。</p>
</li>
</ol>
<h2>延伸閱讀</h2>
<ul>
<li><a href=/blog/posts/designpattern/compositepattern/>[Design Pattern] 掌握設計模式：Composite Pattern原理與應用</a></li>
<li><a href=/blog/posts/designpattern/bridgepattern/>[Design Pattern] 掌握設計模式：Bridge Pattern原理與應用</a></li>
<li><a href=/blog/posts/designpattern/adapterpattern/>[Design Pattern] 掌握設計模式：Adapter Pattern原理與應用</a></li>
<li><a href=/blog/posts/designpattern/prototypepattern/>[Design Pattern] 掌握設計模式：Prototype Pattern原理與應用</a></li>
<li><a href=/blog/posts/designpattern/builderpattern/>[Design Pattern] 掌握設計模式：Builder Pattern原理與應用</a></li>
</ul>