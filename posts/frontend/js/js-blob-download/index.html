<p>要下載PDF文件，我們可以使用fetch API來獲取文件的二進位數據，並將其轉換為Blob對象。然後，我們可以使用URL.createObjectURL()方法來生成一個URL，並將其分配給新建的超連結元素（a標籤）的href屬性。最後，我們可以使用download屬性來指定下載的文件名，並使用click()方法來觸發下載操作。</p>
<h2 id=方法一自動解析http>方法一:自動解析Http</h2>
<p>以下是一份可以下載PDF文件的JavaScript代碼：</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=nx>fetch</span><span class=p>(</span><span class=s1>&#39;&lt;PDF URL&gt;&#39;</span><span class=p>)</span>
  <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>response</span> <span class=p>=&gt;</span> <span class=nx>response</span><span class=p>.</span><span class=nx>blob</span><span class=p>())</span>
  <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>blob</span> <span class=p>=&gt;</span> <span class=p>{</span>
    <span class=kr>const</span> <span class=nx>url</span> <span class=o>=</span> <span class=nb>window</span><span class=p>.</span><span class=nx>URL</span><span class=p>.</span><span class=nx>createObjectURL</span><span class=p>(</span><span class=nx>blob</span><span class=p>);</span>
    <span class=kr>const</span> <span class=nx>a</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s1>&#39;a&#39;</span><span class=p>);</span>
    <span class=nx>a</span><span class=p>.</span><span class=nx>href</span> <span class=o>=</span> <span class=nx>url</span><span class=p>;</span>
    <span class=nx>a</span><span class=p>.</span><span class=nx>download</span> <span class=o>=</span> <span class=s1>&#39;&lt;PDF filename&gt;.pdf&#39;</span><span class=p>;</span>
    <span class=nx>a</span><span class=p>.</span><span class=nx>click</span><span class=p>();</span>
    <span class=nb>window</span><span class=p>.</span><span class=nx>URL</span><span class=p>.</span><span class=nx>revokeObjectURL</span><span class=p>(</span><span class=nx>url</span><span class=p>);</span>
  <span class=p>});</span>
</code></pre></div><blockquote>
<p>需要注意的是，在上述代碼中的<pdf url>和<pdf filename>需要替換為實際的PDF檔案的URL和下載的檔案名稱。</p>
</blockquote>
<p>另外，由於使用了window.URL.createObjectURL()方法生成的URL會占用瀏覽器內存，因此，當用戶完成下載後，我們需要手動釋放這個URL以避免內存泄漏。我們可以在下載完成後，使用以下代碼來釋放URL：</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=nb>window</span><span class=p>.</span><span class=nx>URL</span><span class=p>.</span><span class=nx>revokeObjectURL</span><span class=p>(</span><span class=nx>url</span><span class=p>);</span>
</code></pre></div><p>檔案類型顯式地傳遞給new Blob()建構子，然後創建一個 Blob 物件，而fetch API的response.blob()方法則是自動解析HTTP response中的Content-Type header，並根據其內容類型來創建對應的Blob物件。因此，兩種方式的效果是相同的，皆可用來下載PDF檔案。</p>
<h2 id=方法二new-blob建構子blob-物件>方法二:new Blob()建構子，Blob 物件</h2>
<p>以下是使用new Blob()方式的示例程式碼：</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=nx>fetch</span><span class=p>(</span><span class=s1>&#39;&lt;PDF URL&gt;&#39;</span><span class=p>)</span>
  <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>response</span> <span class=p>=&gt;</span> <span class=nx>response</span><span class=p>.</span><span class=nx>arrayBuffer</span><span class=p>())</span>
  <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>arrayBuffer</span> <span class=p>=&gt;</span> <span class=p>{</span>
    <span class=kr>const</span> <span class=nx>blob</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Blob</span><span class=p>([</span><span class=nx>arrayBuffer</span><span class=p>],</span> <span class=p>{</span> <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;application/pdf&#39;</span> <span class=p>});</span>
    <span class=kr>const</span> <span class=nx>url</span> <span class=o>=</span> <span class=nb>window</span><span class=p>.</span><span class=nx>URL</span><span class=p>.</span><span class=nx>createObjectURL</span><span class=p>(</span><span class=nx>blob</span><span class=p>);</span>
    <span class=kr>const</span> <span class=nx>a</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s1>&#39;a&#39;</span><span class=p>);</span>
    <span class=nx>a</span><span class=p>.</span><span class=nx>href</span> <span class=o>=</span> <span class=nx>url</span><span class=p>;</span>
    <span class=nx>a</span><span class=p>.</span><span class=nx>download</span> <span class=o>=</span> <span class=s1>&#39;&lt;PDF filename&gt;.pdf&#39;</span><span class=p>;</span>
    <span class=nx>a</span><span class=p>.</span><span class=nx>click</span><span class=p>();</span>
    <span class=nb>window</span><span class=p>.</span><span class=nx>URL</span><span class=p>.</span><span class=nx>revokeObjectURL</span><span class=p>(</span><span class=nx>url</span><span class=p>);</span>
  <span class=p>});</span>
</code></pre></div><p>需要注意的是，在創建Blob物件時，需要使用arrayBuffer()方法來獲取檔案的二進位數據，並將其作為Blob物件的參數傳遞。同樣，下載完成後，需要手動釋放URL以避免內存泄漏。
以上就是如何使用JavaScript和fetch API來下載PDF文件的方法，希望對您有所幫助。</p>
<h2>延伸閱讀</h2>
<ul>
<li><a href=/blog/posts/frontend/js/fuse-js-javascript-fuzzy-search-engine/>深入了解 Fuse.js：JavaScript 模糊搜尋</a></li>
<li><a href=/blog/posts/frontend/js/bind-apply-call/>[JavaScript] 讓你馬上了解bind、apply、call的用法</a></li>
<li><a href=/blog/posts/frontend/js/this/>[JavaScript] this是什麼?</a></li>
<li><a href=/blog/posts/frontend/js/iife/>[JavaScript] 立即執行函式(IIFE)是什麼?</a></li>
<li><a href=/blog/posts/frontend/js/var-let-const/>[JavaScript] 不能不知道的 var、let、const 變數宣告</a></li>
</ul>